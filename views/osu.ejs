<!DOCTYPE html>
<html lang="en">
	<!-- HEAD -->
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
		<title>Eggplants</title>   
		<link href="https://fonts.googleapis.com/css?family=Josefin+Sans|Open+Sans|Raleway" rel="stylesheet">
		<link rel="stylesheet" href="css/flexslider.css">
		<link rel="stylesheet" href="css/bootstrap.min.css">
		<link rel="stylesheet" href="css/font-awesome.min.css">
		<link rel="stylesheet" href="css/style.css">
		<link rel="icon" href="/images/eggplant.ico">
	</head>
	<!-- /HEAD -->

	<body>

		<!-- NAV -->
		<% include partials/nav.ejs %>

        <div class="cover">
            <div class="container">
				<div class="col-md-12">
                    <br/></br>
					<h2 class="cent header-text"> EGGPLANTS üçÜ</h2>
                    <h3 class="cent"><i class="fa fa-music"></i> Beatmap Listing</h3>
                    <h4 class="cent">Here, you can search for and find beatmaps to download.</h4>
                    <h4 class="cent">You don't have to be logged into osu! or deal with slow download speeds. So give it a try!</h4>
				</div>
            </div>
        </div>

        <section class="listing">
			<div class="container">
				<br/>
					<div class="col-md-12">
					<h2 class="cent"><i class="fa fa-search"></i> Search For Beatmaps</h2>
					<h4 class="cent">It's simple. Just enter in a search query, fill in the options, and go!</h4>
					<% if (typeof error != 'undefined' && typeof beatmaps == 'undefined') {%>
						<br/>
						<div class="alert alert-danger">
							<center><strong>ERROR: </strong> <%= error %></center>
						</div>	
					<%} else if(typeof beatmaps != 'undefined') { %> 
						<br/>
						<div class="alert alert-success">
							<center><strong>SUCCESS: </strong> There were: <strong><%= beatmaps.length %><%if (beatmaps.length >= 100) {%>+<%}%></strong> beatmaps found!</center>
						</div>							
					<%}%>
				
				</div>

				<form action="/osu" method="POST">
					<div class="row">
						<!-- SEARCH QUERY -->
						<div class="col-md-4">
							<label for="query" class="label-text">Search Query</label>
							<input type="text" class="form-control" name="query" placeholder="Enter an artist, song title, or even mapper!" required>
						</div>
						<!-- /SEARCH QUERY -->

						<!-- RANKED STATUS --> 
						<div class="form-group">
							<div class="col-md-4 col-sm-12">
								<label for="status" class="label-text">Ranked Status</label>
								<select class="form-control" name="status">
									<option value="Ranked">Ranked</option>
									<option value="Qualified">Qualified</option>
									<option value="Loved">Loved</option>
									<option value="All Maps">All Maps</option>
								</select>							
							</div>
						</div>
						<!-- /RANKED STATUS --> 	

						<!-- GAME MODE --> 
						<div class="form-group">
							<div class="col-md-4 col-sm-12">
								<label for="mode" class="label-text">Game Mode</label>
								<select class="form-control" name="mode">
									<option value="osu!">osu!</option>
									<option value="Taiko">Taiko</option>
									<option value="CTB">CTB</option>
									<option value="Mania">Mania</option>
								</select>							
							</div>
						</div>	
						<!-- /GAME MODE --> 

					</div>

					<br/>
					<!-- SUBMIT -->
					<center>
						<button class="btn btn-success">Search!</button>
						<h6>Made w/ üçÜ</h6>
					</center>
					<!-- /SUBMIT -->							
				</form>
					

				<% if (typeof beatmaps != 'undefined' && beatmaps.length > 0) { %>
					<div class="col-md-12">
						<center><button class="btn btn-danger" disabled>Download All</button></center><br/>
					</div>							
				<% } %>	
						<br/><br/>


				<%if (typeof beatmaps != 'undefined' && beatmaps.length > 0) {%>
				  		<% beatmaps.forEach(function(beatmap){ %>

							<div class="col-sm-3 col-md-3">
								<div class="post">
									<div class="post-img-content">
										<img src="http://b.ppy.sh/thumb/<%=beatmap.SetID%>.jpg" class="img-responsive" />
									</div>
									<div class="content">
										<div>
											<strong><h5 class="artist"><i class="fa fa-music"></i> <span class="artist-color">Artist:</span></strong> 
											<% if (beatmap.Artist.length > 18) { %>
												<strong><%= beatmap.Artist.substring(0,18)+'...'; %></strong></h5>
										
											<% } else { %>
												<strong><%=beatmap.Artist%></strong></h5>
											<%} %>											
											<strong><h5 class="title"><i class="fa fa-star"></i> <span class="title-color">Title:</span></strong> 
											<% if (beatmap.Title.length > 18) { %>
												<strong><%= beatmap.Title.substring(0,18)+'...'; %></strong></h5>
										
											<% } else { %>
												<strong><%=beatmap.Title%></strong></h5>
											<%} %>

											<hr>
											<h5><strong>By: <a href="https://osu.ppy.sh/u/<%=beatmap.Creator%>" target="_blank"><%=beatmap.Creator%></a> | <a class="view-on-osu" href="https://osu.ppy.sh/s/<%=beatmap.SetID%>" target="_blank">View on osu!</a></h5></strong>
										</div>
										<div>
											<a class="download btn btn-primary" href="https://storage.ripple.moe/<%=beatmap.SetID%>.osz" target="_blank" class="btn btn-primary btn-sm">Download</a>
										</div>
									</div>
								</div>
							</div>

						<%});%>
				<%}%> 
			</div>
        </section>

		<!-- jQuery & Exta JavaScript -->
		<script src="js/jquery.min.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<script src="js/jquery.inview.js"></script>
		<script src="js/script.js"></script>	
	</body>
</html>